<!DOCTYPE html><html><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="preload" href="/component---src-layouts-index-js-514cf5b263c2dc3f32b7.js" as="script"/><link rel="preload" href="/component---src-templates-blog-post-js-0668ad1c8e9fa38db975.js" as="script"/><link rel="preload" href="/path---improve-ngfor-usability-and-performance-with-trackby-042d01d025eb0ce460ab.js" as="script"/><link rel="preload" href="/app-32041960ae6798d4138a.js" as="script"/><link rel="preload" href="/commons-403258ad126d5c26671b.js" as="script"/><title data-react-helmet="true">Simars.io</title><meta data-react-helmet="true" name="description" content="Simar Paul Singh | Personal Portal and Blog "/><meta data-react-helmet="true" name="keywords" content="simars, blog, programming, coding, learning, tutorial, angular, ES, ECMAScript, JS, JavaScript, TS ,TypeScript gatsby, react, Java, Kotlin, Spring"/><style id="gatsby-inlined-css">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects;color:#333;text-decoration:none}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.45em georgia,serif;box-sizing:border-box;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{color:rgba(0,0,0,.8);font-family:georgia,serif;font-weight:400;word-wrap:break-word;-webkit-font-kerning:normal;font-kerning:normal;-ms-font-feature-settings:"kern","liga","clig","calt";-webkit-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt","kern"}img{max-width:100%;margin:0 0 1.45rem;padding:0}h1{font-size:2.25rem}h1,h2{margin:0 0 1.45rem;padding:0;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{margin:0 0 1.45rem;padding:0;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{margin:0 0 1.45rem;padding:0;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h6{font-size:.78405rem}hgroup{margin:0 0 1.45rem;padding:0}ol,ul{margin:0 0 1.45rem 1.45rem;padding:0;list-style-position:outside;list-style-image:none}dd,dl,figure,p{margin:0 0 1.45rem;padding:0}pre{padding:0;font-size:.85rem;line-height:1.42;background:rgba(0,0,0,.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.45rem}pre,table{margin:0 0 1.45rem}table{padding:0;font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%}fieldset{margin:0 0 1.45rem;padding:0}blockquote{margin:0 1.45rem 1.45rem;padding:0}form,iframe,noscript{margin:0 0 1.45rem;padding:0}hr{margin:0 0 calc(1.45rem - 1px);padding:0;background:rgba(0,0,0,.2);border:none;height:1px}address{margin:0 0 1.45rem;padding:0}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-left:1.45rem;margin-bottom:.725rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:SFMono-Regular,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;padding:0;padding-top:.2em;padding-bottom:.2em}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{letter-spacing:-.2em;content:" "}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}</style></head><body><div id="___gatsby"><div data-reactroot="" data-reactid="1" data-react-checksum="-648103479"><!-- react-empty: 2 --><div style="background:#333;margin-bottom:0px;" data-reactid="3"><div style="margin:0 auto;max-width:960px;padding:1.45rem 1.0875rem;" data-reactid="4"><h1 style="margin:0;" data-reactid="5"><a style="color:white;text-decoration:none;" href="/" data-reactid="6">Simars.io</a></h1></div></div><div style="background:#f4f4f4;padding-top:10px;" data-reactid="7"><ul style="list-style:none;display:flex;justify-content:space-evenly;" data-reactid="8"><li data-reactid="9"><a href="/" data-reactid="10">Home</a></li><li data-reactid="11"><a href="/about" data-reactid="12">About</a></li><li data-reactid="13"><a href="/blog" data-reactid="14">Blog</a></li></ul></div><div style="margin:0 auto;max-width:960px;padding:0px 1.0875rem 1.45rem;padding-top:0;" data-reactid="15"><div data-reactid="16"><a href="/blog" data-reactid="17">Go Back</a><hr data-reactid="18"/><h1 data-reactid="19">Improve Angular’s *ngFor performance and usability with trackBy</h1><h4 data-reactid="20"><!-- react-text: 21 -->Posted by <!-- /react-text --><!-- react-text: 22 -->Simar Paul Singh<!-- /react-text --><!-- react-text: 23 --> on <!-- /react-text --><!-- react-text: 24 -->2018-04-09<!-- /react-text --></h4><div data-reactid="25"><hr>
<h3>Prevent loss of focus and reconstruction of elements in your *ngFor on collection change with trackBy</h3>
<p>Note: “change the collection-data” means to replace the collection with new objects and not just modifying the objects in the same collection object.</p>
<hr>
<h3>Let us consider a following example.</h3>
<h4>Tracking *ngFor on array of items changing every 5 seconds to switch line bullets between English &#x26; Spanish in different colors</h4>
<h4>Find full implementation on <a href="https://github.com/simars/angular-lessons/tree/master/projects/ngx-lesson-ngfor-trackby/src/lib">Github</a> and play with it on <a href="https://codepen.io/simars/pen/KBGZVw">CodePen</a> or <a href="https://stackblitz.com/edit/angular-ngfor-tracking">StackBlitz</a></h4>
<hr>
<h2>Without trackBy :(</h2>
<h4>ngFor here is not tracking elements by id or index. When items-collection changes ngFor just destroys and recreates elements for each item in the collection.</h4>
<h4>Try inputting text in the first set of input boxes available on any of these links [<a href="https://codepen.io/simars/pen/KBGZVw">CodePen</a>] or <a href="https://angular-ngfor-tracking.stackblitz.io">[StackBlitz]</a></h4>
<h4>Notice, as the *ngFor items change, the focus and cursor from the input box you were typing in goes away, and you will find you aren’t typing anywhere.</h4>
<h4>On mobile browsers it is even worse. Every time focus from active input is lost, the soft-keyboard closes</h4>
<p><img src="https://cdn-images-1.medium.com/max/1400/1*NNOu-AZIHmWFeFiLPqgrtA.gif"></p>
<hr>
<h2>With track by :)</h2>
<h4>ngFor is tracking each element to its rendering in dom by id, and it just renders the corresponding changes in place using using standard change detection instead of destroying and recreating elements</h4>
<h3>ngFor with trackBy</h3>
<h4>Try inputting text in the second set of input boxes available on this these links [<a href="https://codepen.io/simars/pen/KBGZVw">CodePen</a>] or [<a href="https://angular-ngfor-tracking.stackblitz.io">StackBlitz</a>].</h4>
<h4>Notice, as the ngFor items change, the text, focus and cursor in the active input box stays, and you can continue typing even as the bullets keep changing</h4>
<p><img src="https://cdn-images-1.medium.com/max/1400/1*upjr4zfKw-dEcsmGaVHe0A.gif"></p>
<h4>Note: If you don’t have id (unique-key) for each data-item in your collection, you can always trackBy index (second argument passed to trackByFn). If you use a field to track by that is not unique across items in your collection, angular will throw an error</h4>
<h3>Why is trackBy so important for Angular?</h3>
<p>Angular by default tracks items in a collection by object reference. When we replace the collection with new collection which is not keeping the same objects by reference, Angular can’t keep track of items in the collection even if the objects inside the new collection are same by values, but just clone of previous ones.</p>
<p>Unless trackBy provides a unique id per element in *ngFor iteration, angular will have no knowledge of which items have been removed or added or changed in the new collection.</p>
<p>As a result, Angular needs to remove all the DOM elements that associated with the data items in collection and create them again ( unnecessary DOM manipulations).</p>
<p>We all know DOM manipulations are expensive, and for a collection of (n) items, it’s of order(n). Also on every recreation, any focus from the element is lost posing a big usability problem as user may not understand where and why the cursor / focus went away from active element recreated.</p>
<p>Hence, for performance and usability, prefer using trackBy with *ngFor unless the collection never changes and / or items are expected to lose all state on change and be recreated which is seldom the case.</p>
<p>If you liked this article please click the ❤ below or (clap) on <strong><a href="https://medium.com/simars/improve-ngfor-usability-and-performance-with-trackby-97f32ab92f1c">Medium</a></strong> on the left side. It’ll motivate me to write more articles like this, and it’ll help other people discover the article as well.</p></div></div></div></div></div><script id="webpack-manifest">/*<![CDATA[*/window.webpackManifest={"231608221292675":"app-32041960ae6798d4138a.js","107818501498521":"component---src-templates-blog-post-js-0668ad1c8e9fa38db975.js","162898551421021":"component---src-pages-404-js-4503918ea3a16cfcdb75.js","263791100135453":"component---src-pages-about-js-6319267f54538decc071.js","212839066777427":"component---src-pages-blog-js-aa3cc5798fad47d08183.js","35783957827783":"component---src-pages-index-js-42105bb6addd426b1edf.js","60335399758886":"path----6bb8d3498a44ed0a3478.js","371127763309":"path---improve-ngfor-usability-and-performance-with-trackby-042d01d025eb0ce460ab.js","86583290751729":"path---create-generic-angular-pipes-apply-and-applypure-0cf3926cb648c5d9256a.js","223480463421619":"path---manage-scrolls-on-router-outlets-angular-0a753f495e1f1005d613.js","45993978181358":"path---custom-transitive-validators-in-reactive-forms-angular-d4d23279473d16cd1c16.js","254022195166212":"path---404-a0e39f21c11f6a62c5ab.js","273950069227526":"path---about-a0e39f21c11f6a62c5ab.js","49683490770531":"path---blog-dd4a9be6dcddad39c04d.js","142629428675168":"path---index-dd4a9be6dcddad39c04d.js","178698757827068":"path---404-html-a0e39f21c11f6a62c5ab.js","114276838955818":"component---src-layouts-index-js-514cf5b263c2dc3f32b7.js"}/*]]>*/</script><script>/*<![CDATA[*/!function(e,t,r){function n(){for(;d[0]&&"loaded"==d[0][f];)c=d.shift(),c[o]=!i.parentNode.insertBefore(c,i)}for(var s,a,c,d=[],i=e.scripts[0],o="onreadystatechange",f="readyState";s=r.shift();)a=e.createElement(t),"async"in i?(a.async=!1,e.head.appendChild(a)):i[f]?(d.push(a),a[o]=n):e.write("<"+t+' src="'+s+'" defer></'+t+">"),a.src=s}(document,"script",["/commons-403258ad126d5c26671b.js","/app-32041960ae6798d4138a.js","/path---improve-ngfor-usability-and-performance-with-trackby-042d01d025eb0ce460ab.js","/component---src-templates-blog-post-js-0668ad1c8e9fa38db975.js","/component---src-layouts-index-js-514cf5b263c2dc3f32b7.js"])/*]]>*/</script></body></html>